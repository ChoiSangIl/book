# 예측 가능한 코드를 작성하라

## 매직값을 반환하지 말아야 한다
매직값의 일반적인 예는 값이 없거나 오류가 발생했음을 나타내기 위해 -1을 반환 하는 것이다.

### 매직값은 버그를 유발할 수 있다
```
class User{
   Int getAge() {...}
}

Double? getMeanAge(List<User> users){
   if(users.isEmpty()){
      return null;
   }
   Double sumOfAges = 0.0;
   for (User user in users){
     sumOfAges += user.getAge().toDouble();
   }
   return sumOfAges / users.size().toDouble();
}
```

"리눅스 공부 할 때 -1을 리턴하는 경우를 많이 본거 같다. 그 외 실무에서는 한번도 경험한적이 없다.   
한가지 생각해봐야 할 점은 다른 개발자가 getAge()라는 함수를 사용 한다고 했을 때, 세부사항을 보고 -1을 리턴한다는 사실을 놓칠 수 있다는 점인거 같다(세부사항이 복잡할 수록 더욱 더).  
결국 해당 함수를 잘못 사용할 수 있다. 이것은 누구 탓인가? 세부사항을 모르고 사용한 사람의 잘못일까 오용할 수 있게 만든 사람의 잘못일까? 둘 중에 하나라도 되고싶진 않다."

### 매직값의 해결책: 널, 옵셔널 또는 오류를 반환하라

### 때때로 매직값이 우연히 발생할 수 있다.
"이런 경우도 생길 수 있구나. 책에서 말하듯 널, 옵셔널 또는 오류를 반환하는 것이 좋다."

## 널 객체 패턴을 적절히 사용하라
#### 널 객체 패턴란
- 널이나 빈 옵셔널을 반환하는 대신 빈 리스트나 빈 문자열 또는 기본값을 반환하는 클래스를 리턴하는 것"

"하지만 100% 정답은 없다. 그때 마다 다르다. 부적절하게 사용되면 예측을 벗어나는 동작을 하거나 발견하기 어려운 미묘한 버그가 발생할 수 있다."
### 빈 컬렉션을 반환하면 코드가 개선될 수 있다
"널 안정성을 지원하는 언어(kotlin)에서 널을 리턴하게 되면 사용하는 클라이언트에서 널에 관련된 처리를 해줘야 하는 경험을 많이 했다. 그래서 꼭 널 처리를 해줘야할 필요가 없는 경우에는 빈 리스트를 반환 하거나 하는 처리를 했던거 같다.  
하지만 책에서 언급 되듯 빈 리스트나 빈 스트링을 리턴해주면 호출하는 쪽의 코드는 간단해지고 예측을 벗어나는 작동을 할 가능성이 매우 낮다. 하지만 만병 통치약은 아니다(특정 복잡한 상황에서는 이점이 적어질 수 있다)"
### 빈 문자열을 반환하는 것도 때로는 문제가 될 수 있다.
-> ID 로서의 문자열
### 더 복잡한 널 객체는 예측을 벗어날 수 있다
> 새 스마트폰을 사려고 한다고 상상해보자. 전자제품 매장에 가서 어떤 모델을 사고 싶은지 매장 점원에게 말한다. 점원은 빛나는 새 폰이 들어 있는 밀봉된 박스를 내어줄 것이다. 집에 가서 셀로판지를 뜯고 박스를 열었는데 안에 아무것도 없다.
> 이것은 예상을 벗어난 황당무계한 일이고, 새 전화기가 필요한 이유에 따라 더 나쁜 결과를 초래할 수도 있다.

"재미있는 비유이다 찰떡이다"
## 예상치 못한 부수 효과를 피하라
함수가 반환 하는 값 외에 다른 효과가 있다면 이는 부수 효과(side effect)가 있는 것이다.
### 분명하고 의도적인 부수 효과는 괜찮다.
당연히 해당 부수 효과가 의도한 대로 수행된다면 문제가 되지 않는다.
### 예기치 않은 부수 효과는 문제가 될 수 있다
#### 호출한 쪽의 가정을 깨트리기
특정 함수명을 보고 이 함수는 이런 행동을 하는구나 라고 예측하고 사용했는데 예상치 못한 부수 효과가 있다면 버그를 일으킬 가능성이 있다.
#### 다중 스레드 코드의 버그
이런 부수효과 들은 다중 스레드 환경에서도 문제가 될 소지가 크다. 특히 다중 스레드 문제와 관련된 버그는 디버깅과 테스트가 어렵다.
### 해결책: 부수 효과를 피하거나 그 사실을 분명하게 하라
"결국 예상치 못한 부수효과를 피하려면 해당 함수가 수행 하는일을 함수명으로 표현해주는 것이 좋다는 말인거 같다. 잘못된 함수명은 사용하는 입장에서 특정 사이드이펙트가 나는 것을 생각하기 힘들고 결국 오류로 향하게 된다 아멘"

## 입력 매개변수를 수정하는 것에 주의하라
### 입력 매개변수를 수정하면 버그를 초래할 수 있다.
### 변경하기 전에 복사하라
"어디선가 특정 매개변수의 값이 수정되면 오류를 찾기 힘들뿐만 아니라 재앙으로 향했던 경험을 몇 번은 해본 것 같다. 매개변수를 받는 입장이나 특정 값을 리턴하는 함수에서는 항상 불변을 유지할 수 있게 만드는 것이 중요한거 같다."

## 오해를 일으키는 함수는 작성하지 말라
### 중요한 입력이 누락되었을 때 아무것도 하지 않으면 놀랄 수 있다
### 해결책 중요한 입력은 필수 항목으로 만들라
자바에서는 @CheckReturnValue 어노테이션을 사용할 수 있다.

## 미래를 대비한 열거형 처리
"책에서 언급하듯 열거형 사용에 관련해 많은 개발자들 사이에 논쟁이 되는거 같다. 하지만 결국 어디선가는 열거형을 사용해야 되는 경우가 생기는데 미래의 값이 추가 되었을 경우 적절하게 처리가 안되어 있으면 미래에 오류가 날 수 있다는 것을 이야기 한다. 다시한번 생각해본다 코틀린 좋다!"

## 느낀점
"이렇게 사용하는 사람이 있을까? 라는 예제도 많았지만 다시한번 생각하게되는.... 나에게 명백하다고 남에게도 명백한건 아니다..! 또한 많은 개발자들은 세부사항을 주의 깊게 안 볼 가능성이 크다. 명백한 부분 쉽게 확인할 수 있는 부분에서 확실하게 알 수 있게 만들자!(적절한 함수명, 입력값, 리턴 타입, 오류처리)"
